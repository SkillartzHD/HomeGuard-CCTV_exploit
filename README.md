# HomeGuard-CCTV_exploit

## 

For starters it should be noted that this only works on the dvr model called "homeguard HGDVK46702P", but in the investigation we did it is possible that there are several vulnerable devices in this case given that it is a product imported from China and renamed to another name, so there may be other products with a completely different name or model even as an interface.

## How does it work?

### Unauthorized access

Simple, once a user/admin has logged in to the panel then the system stores a session that has an expiration time of about 30m-1h (no cookie) when the user has logged out, if the user did not close the session then there is no time limit, then someone external can intervene without any authentication if that session-id is correct to edit/add data to the DVR

### Server Remote Crash

Much simpler, just send a request to / RPC2 null, then the whole system crashes and receives a restart in 5 minutes.

### Dependencies

* .net core - https://dotnet.microsoft.com/download

### Executing program

* `-ip = dvr ip address`
* `-l = loop for that "session-id"`
* `-c = server remote crash"`

##### example unauthorized access

```sh 
rpc_unauthorized_exploit.exe -ip "192.168.0.102" -l 100
```

![Untitled](https://user-images.githubusercontent.com/8433325/132115238-27a53a8e-2271-4745-9d5a-c2b27ece515c.png)


##### example remote crash

```sh 
rpc_unauthorized_exploit.exe -ip "192.168.0.102" -c
```

![Untitled](https://user-images.githubusercontent.com/8433325/132124660-e5e90871-16b1-400d-a5a1-8846a9a73857.png)



### POC
[unauthorized access video](https://www.youtube.com/watch?v=h8F0TSVT14U)

[remote crash video](https://www.youtube.com/watch?v=bNQ_rrPBrOQ)




